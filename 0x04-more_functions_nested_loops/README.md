more functionos and more nested loops
